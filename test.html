<div class="paget page">
    <div id="atest" class="card-list">

        <!-- <a href="javascript:IfmChange('https://chonsa29.github.io/intro/main.html')"  class="card"> 천상욱 </a>
        <a href="javascript:IfmChange('https://jonagyeong.github.io/intro/profil.html')"  class="card"> 조나경 </a>
        <a href="javascript:IfmChange('https://saebyeol5285.github.io/intro/intro_upload.html')" class="card"> 박새별 </a>
        <a href="javascript:IfmChange('https://codingjs12.github.io/introduce/intro.html')" class="card"> 강재석 </a>
        <a href="javascript:IfmChange('https://taehun92.github.io/intro_main/intro/intro.html')" class="card"> 이태훈 </a>
        <a href="javascript:IfmChange('https://latte28.github.io/Intro/intro.html')" class="card"> 박재원 </a>
        <a href="javascript:IfmChange('https://minamryu.github.io/Intro/profile.html')" class="card"> 유승호 </a>
        <a href="javascript:IfmChange('https://leejh8997.github.io/intro/profile.html')" class="card"> 이재형 </a>
        <a href="javascript:IfmChange('https://yeonju02.github.io/intro/intro.html')" class="card"> 조연주 </a>
        <a href="javascript:IfmChange('https://chunsamkim.github.io/hosting/profile.html')" class="card"> 김정철 </a>
        <a href="javascript:IfmChange('https://nerongnyr.github.io/intro/profile.html')" class="card"> 나예린 </a>
        <a href="javascript:IfmChange('https://sbsssb.github.io/intro/myprofile.html')" class="card"> 윤수빈 </a>
        <a href="javascript:IfmChange('https://honggiyoung.github.io/intro/sample.html')" class="card"> 홍영은 </a>
        <a href="javascript:IfmChange('https://prprspr.github.io/intro/intro.html')" class="card"> 신수빈 </a>
        <a href="javascript:IfmChange('https://glodstone1.github.io/intro/Test.html')" class="card"> 김성규 </a>
        <a href="javascript:IfmChange('https://lhy950626.github.io/intro/test2.html')" class="card"> 이흥열 </a>
        <a href="javascript:IfmChange('https://geon-hyung.github.io/intro/myself.html')" class="card"> 초초총 </a>
        <a href="javascript:IfmChange('https://yulyuling.github.io/intro/intro/index.html')" class="card"> 율유링 </a>
        <a href="javascript:IfmChange('https://suikari.github.io/intro/main.html')" class="card"> 방대한 </a> -->

    </div>
    <div id="list_div" class="card-list-div"  >

    </div>

    <div id="list_detail_div" class="card-list-div"  >

    </div>

    <div id="ifm_div" style= "height: 700px;display: none;" >
        <iframe width="100%" height="100%" src="" name="Ifrm" id="Ifrm" frameborder="1" scrolling="yes" align="left" style="border:none">
        </iframe>
    </div>

</div>



<style>

    .card-list {
        margin : 30px;
    }

    .card-list a {
        background-color: aliceblue;
        cursor: pointer;
        border: 1px solid aliceblue;
        border-radius: 15%;
    }

    .card-list{
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    }

    .card-list-div {
        display: block;
        margin-bottom: 20px;
    }

    .card-list-div a {
        background-color: aliceblue;
        cursor: pointer;
        border: 1px solid aliceblue;
        border-radius: 15%;
    }

    .card{
        padding: 5px;
        min-width: 50px;
        scroll-snap-align: center;
        margin-bottom: 5px;
    }


    .card-list::-webkit-scrollbar {
        height: .5rem;
        background-color: maroon;
    }

    .card-list::-webkit-scrollbar-thumb{
        background-color: white;
        border-radius: 10px;
    }

    .card:hover{
        transform: translateY(-.5rem);
    }
    .card:hover ~ .card{
        transform: translateX(1rem);
    }

</style>

<script>

    function utf8_to_b64( str ) {
    return window.btoa(unescape(encodeURIComponent( str )));
    }

    function b64_to_utf8( str ) {
    return decodeURIComponent(escape(window.atob( str )));
    }

    g_token = 'gi' + 'thub_'+'pat_'+'11BOD'+'3YWY0'+'iJaHVP'+'ik0hX'+'r_pTDSD'+'ATphWLly'+'IPBPeC'+'k3MomY'+'EiLrGnBY'+'zRmjcXN'+'w2ZJCRY'+'ROTXw'+'ueK9WYI';


    function IfmChange( src ){
	    $('#Ifrm').attr('srcdoc', src);
        $('#ifm_div').attr('style', 'max-width:800px; max-height: 700px; height:100%;display:block');
    }   



    async function getUserRepos(username, token) {
        const response = await fetch(`https://api.github.com/users/${username}/repos`, {
                method: 'GET',
                headers: {
                    'Authorization': `token ${token}`, // 인증된 요청을 위해 토큰 추가
                    'Accept': 'application/vnd.github.v3+json'
                }
            });

        const data = await response.json();
        console.log(data);

        for (let i = 0; i < data.length; i++) {
            getRepoInfo("suikari", data[i].name , token );            
        }

    }

    getUserRepos("suikari",g_token);

    async function getRepoInfo(owner, repo , token) {
    const response = await fetch(`https://api.github.com/repos/${owner}/${repo}`, {
                method: 'GET',
                headers: {
                    'Authorization': `token ${token}`, // 인증된 요청을 위해 토큰 추가
                    'Accept': 'application/vnd.github.v3+json'
                }
            });
    const data = await response.json();
    console.log(data);

    if (!(typeof data == "undefined" || data == null || data == "")) {

        let html = "";

        html += '<a href="javascript:getlist(\''+ data.name +'\')"  class="card"> '+ data.name +' </a>';

        $("#atest").append(html);    
    }
        
    
    }

    function getlist ( src ) {
        getRepoInfo1(src, g_token);

    }
    //https://api.github.com/repos/suikari/html/contents/day1/area.html
    async function getRepoInfo1( repo, token) {

        fetch(`https://api.github.com/repos/suikari/${repo}/contents/`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `token ${token}`, // 인증된 요청을 위해 토큰 추가
                        'Accept': 'application/vnd.github.v3+json'
                    }
                })
        .then(response => response.json())
        .then(data => {
            //const content = atob(data.content);  // base64 디코딩
            console.log(data);
            //document.getElementById('파일내용').innerText = content;
            $("#list_div").empty();    

            for (let i = 0; i < data.length; i++) {                
                let html = "";

                html += '<a href="javascript:getRepoInfo2(\''+ repo+'\',\''+ data[i].name +'\')"  class="card"> '+ data[i].name +' </a>';

                $("#list_div").append(html);   
            }

        });
    }

    //https://api.github.com/repos/suikari/html/contents/day1/area.html
    async function getRepoInfo2( repo, content ) {
        if (content.indexOf('\.html') > -1 ) {

            //console.log(`https://api.github.com/repos/suikari/${repo}/contents/${content}`);
            fetch(`https://api.github.com/repos/suikari/${repo}/contents/${content}`, {
                        method: 'GET',
                        headers: {
                            'Authorization': `token ${g_token}`, // 인증된 요청을 위해 토큰 추가
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    })
            .then(response => response.json())
            .then(data => {
                let b_content = b64_to_utf8(data.content);  // base64 디코딩
                //console.log(b_content);
                IfmChange(b_content);
                $("#list_div").empty();    
                $("#list_detail_div").empty();   
            });
        } else {    
            //console.log(`https://api.github.com/repos/suikari/${repo}/contents/${content}/`);
            fetch(`https://api.github.com/repos/suikari/${repo}/contents/${content}/`, {
                        method: 'GET',
                        headers: {
                            'Authorization': `token ${g_token}`, // 인증된 요청을 위해 토큰 추가
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    })
            .then(response => response.json())
            .then(data => {
                //const content = atob(data.content);  // base64 디코딩
                console.log(data);
                //document.getElementById('파일내용').innerText = content;
                $("#list_detail_div").empty();    

                for (let i = 0; i < data.length; i++) {                
                    let html = "";

                    html += '<a href="javascript:getRepoInfo3(\''+ repo +'\',\''+ content +'\',\''+ data[i].name +'\')"  class="card"> '+ data[i].name +' </a>';

                    $("#list_detail_div").append(html);   
                }

            });
        }
    }

    async function getRepoInfo3( repo, content , name ) {
        if (name.indexOf('\.html') > -1 ) {

            //console.log(`https://api.github.com/repos/suikari/${repo}/contents/${content}`);
            fetch(`https://api.github.com/repos/suikari/${repo}/contents/${content}/${name}`, {
                        method: 'GET',
                        headers: {
                            'Authorization': `token ${g_token}`, // 인증된 요청을 위해 토큰 추가
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    })
            .then(response => response.json())
            .then(data => {
                let b_content = b64_to_utf8(data.content);  // base64 디코딩
                //console.log(b_content);
                IfmChange(b_content);
                $("#list_div").empty();    
                $("#list_detail_div").empty();   
            });
        }
    }
</script>